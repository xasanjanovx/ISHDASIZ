# Prompt для Gemini: Рекомендации по AI-архитектуре для ISHDASIZ

Скопируй этот текст и вставь в Gemini (или AI Studio):

---

## КОНТЕКСТ ПРОЕКТА

Я разрабатываю **ISHDASIZ** — портал поиска работы для Узбекистана (как HeadHunter/Indeed).

### Стек технологий:
- **Frontend**: Next.js 13.5, React 19, TypeScript, Tailwind CSS
- **Backend**: Next.js API Routes (serverless)
- **База данных**: Supabase (PostgreSQL)
- **AI**: Google Gemini API (gemini-2.5-flash)
- **Языки контента**: Узбекский (основной), Русский

### Структура данных в базе:

```sql
-- Вакансии
jobs (
  id, title_uz, title_ru, description_uz, description_ru,
  requirements_uz, requirements_ru, benefits,
  salary_min, salary_max, work_mode (remote/onsite/hybrid),
  category_id, region_id, district_id, company_name,
  is_active, is_for_students, is_for_disabled,
  raw_source_json (полный JSON из внешних источников),
  created_at
)

-- Категории (9 штук)
categories (id, name_uz, name_ru, slug)
-- IT, Savdo, Transport, Tibbiyot, Ta'lim, Qurilish, Moliya, Xizmatlar, Ishlab chiqarish

-- Регионы (14 штук)
regions (id, name_uz, name_ru)
-- Toshkent shahri, Andijon, Samarqand, и т.д.

-- Резюме
resumes (id, user_id, full_name, position, skills, experience, education, ...)
```

### Текущая архитектура AI-чата:

```
User Message
     ↓
extractInfo()     — Regex-парсинг: категория, регион, зарплата, опыт
     ↓
shouldSearch()?   — Есть ли достаточно информации?
     ↓
NO → buildQuestion() — Задаём следующий вопрос
YES ↓
searchJobs()      — SQL запрос в Supabase
     ↓
Format Response   — Возвращаем вакансии
```

---

## ТЕКУЩИЕ ПРОБЛЕМЫ

1. **Тупой поиск**: AI не понимает контекст. "ish kerak" сразу ищет все вакансии.

2. **Нет анализа вакансий**: Возвращает всё подряд без объяснения почему подходит.

3. **Не понимает навыки**: Не спрашивает "что умеете делать?", сразу ищет по категории.

4. **Нет персонализации**: Не учитывает историю, предпочтения пользователя.

5. **Не даёт советов**: Не говорит "вам стоит подтянуть X навык" или "эта вакансия выше вашего уровня".

6. **Не понимает сложные запросы**: "Ищу работу в IT, но я без опыта, живу в Андижане, готов на удалёнку, минимум 3 млн".

---

## ЧТО Я ХОЧУ

AI должен вести себя как **настоящий HR-консультант**:

1. **Сначала узнать о человеке**:
   - Какие навыки/образование?
   - Какой опыт работы?
   - Где живёт?
   - Какие ожидания по зарплате?
   - Офис или удалёнка?

2. **Потом умно искать**:
   - Анализировать ПОЛНЫЙ текст вакансии (description, requirements)
   - Сопоставлять навыки пользователя с требованиями
   - Фильтровать нерелевантные (IT ≠ shifokor)

3. **Объяснять каждую вакансию**:
   - "Эта работа подходит потому что..."
   - "Требуется X, у вас есть Y — mos keladi"
   - "Зарплата выше вашего минимума"

4. **Давать советы**:
   - "Для этой вакансии нужен английский — советую подтянуть"
   - "Мало вакансий в вашем городе — рассмотрите удалёнку?"

5. **Помнить контекст**:
   - Если сказал "bu emas" — понять что не подходит и не показывать похожее
   - Учитывать предыдущие ответы

---

## ВОПРОСЫ К ТЕБЕ

1. **Какую архитектуру AI ты рекомендуешь** для такого проекта?
   - Один вызов Gemini или несколько специализированных?
   - Как структурировать промпты?
   - RAG нужен или хватит прямого SQL?

2. **Как организовать сбор профиля**?
   - Фиксированные вопросы или динамические?
   - Сколько вопросов оптимально?
   - Как понять что "достаточно информации"?

3. **Как анализировать вакансии на релевантность**?
   - Gemini для каждой вакансии (дорого)?
   - Embeddings + vector search?
   - Keyword matching с весами?

4. **Как структурировать JSON ответы AI**?
   - Какие поля обязательны?
   - Как обрабатывать intent (search/clarify/advice)?

5. **Как оптимизировать токены и скорость**?
   - Какие данные кэшировать?
   - Как сократить промпт без потери качества?

---

## ОГРАНИЧЕНИЯ

- Бюджет: Gemini API (бесплатный/дешёвый тир)
- Модель: gemini-2.5-flash (быстрая)
- Время ответа: < 3 секунды
- Пользователи: в основном на узбекском языке

---

Пожалуйста, предложи **детальную архитектуру** с:
- Диаграммой потока данных
- Примерами промптов
- JSON схемами
- Конкретными рекомендациями
